!function(t){"use strict";var e=function(){function t(t,e){for(var a in e){var n=e[a];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(t,e)}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(t){var o=t.fn.wysiwyg,l={toolbar:[["mode"],["operations",["undo","rendo","cut","copy","paste"]],["styles"],["fonts",["select","size"]],["text",["bold","italic","underline","strike","subscript","superscript","color"]],["align",["left","center","right","justify"]],["lists",["unordered","ordered","indent","outdent"]],["components",["table","chart"]],["intervals",["line-height","letter-spacing"]],["insert",["emoji","link","image","video","symbol","bookmark"]],["special",["print","unformat","clean"]],["fullscreen"]],mode:"editor",fontSizes:["8px","9px","10px","11px","12px","14px","15px","16px","18px","20px","24px","30px","32px","36px","48px"],fontSizeDefault:["12px"],fontFamilies:["Open Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],fontFamilyDefault:["Open Sans"]},i=function(){function o(e,n){var i=this;a(i,o),i._config=t.extend({},l,n),i._editorId="wysiwyg-"+(String.fromCharCode(Math.floor(11*Math.random()))+Math.floor(1e6*Math.random())).trim(),i._$element=e instanceof jQuery?e:t(e),i._inputId=i._$element.attr("id"),i._$editor=t('<div id="'+i._editorId+'" aria-describedby="#'+i._inputId+'" class="wysiwyg-editor" />'),i._$element.wrap(i._$editor),i._$content=t('<div class="editor-content" contenteditable="true" />'),i._$content.html(i._$element.val()),i._$element.before(i._$content),i._source=i._$element.val(),i._$toolbar=t('<div class="wysiwyg-toolbar btn-toolbar" />'),i._$content.before(i._$toolbar),i._$statusbar=t('<div class="editor-statusbar" />'),i._$statusbar.stat=t('<span class="editor-statusbar-stat" />'),i._$statusbar.path=t('<span class="editor-statusbar-path" />'),i._$statusbar.append(i._$statusbar.stat),i._$statusbar.append(i._$statusbar.path),i._$content.after(i._$statusbar),i._$element.addClass("hide"),"object"==typeof i._config.toolbar&&t.each(i._config.toolbar,function(e,a){var n=t('<div class="btn-group" role="group" aria-label="..." />');if("mode"===a[0])n.append(i._buildTollbarButton("mode","editor","fa fa-eye",null)),n.append(i._buildTollbarButton("mode","source","fa fa-code",null));else if("operations"===a[0])n.append(i._buildTollbarButton("operations","undo","fa fa-mail-reply",null)),n.append(i._buildTollbarButton("operations","rendo","fa fa-mail-forward",null)),n.append(i._buildTollbarButton("operations","cut","fa fa-cut",null)),n.append(i._buildTollbarButton("operations","copy","fa fa-copy",null)),n.append(i._buildTollbarButton("operations","paste","fa fa-clipboard",null));else if("styles"===a[0]){n.append(i._buildTollbarDropdown("select-style",{"Header H1":{action:"formatblock",value:"h1",wrap:"<h1 />"},"Header H2":{action:"formatblock",value:"h2",wrap:"<h2 />"},"Header H3":{action:"formatblock",value:"h3",wrap:"<h3 />"},"Header H4":{action:"formatblock",value:"h4",wrap:"<h4 />"},"Header H5":{action:"formatblock",value:"h5",wrap:"<h5 />"},"Header H6":{action:"formatblock",value:"h6",wrap:"<h6 />"},Paragraph:{action:"formatblock",value:"p",wrap:"<p />"},Blockquote:{action:"formatblock",value:"blockquote",wrap:"<blockquote />"},Preformatted:{action:"formatblock",value:"pre",wrap:"<pre />"},"Div block":{action:"formatblock",value:"div",wrap:"<div />"}},"Paragraph"))}else if("fonts"===a[0]){if(-1!==a[1].indexOf("select",0)){var o={};t.each(i._config.fontFamilies,function(t,e){o[e]={action:"fontname",value:e,style:"font-family: "+e+";"}}),n.append(i._buildTollbarDropdown("font-select",o,i._config.fontFamilyDefault))}if(-1!==a[1].indexOf("size",0)){var l={};t.each(i._config.fontSizes,function(t,e){l[e]={action:"fontsize",value:e}}),n.append(i._buildTollbarDropdown("font-size",l,i._config.fontSizeDefault))}}else"text"===a[0]?(-1!==a[1].indexOf("bold",0)&&n.append(i._buildTollbarButton("text","bold","fa fa-bold",null)),-1!==a[1].indexOf("italic",0)&&n.append(i._buildTollbarButton("text","italic","fa fa-italic",null)),-1!==a[1].indexOf("underline",0)&&n.append(i._buildTollbarButton("text","underline","fa fa-underline",null)),-1!==a[1].indexOf("strike",0)&&n.append(i._buildTollbarButton("text","strike","fa fa-strikethrough",null)),-1!==a[1].indexOf("subscript",0)&&n.append(i._buildTollbarButton("text","subscript","fa fa-subscript",null)),-1!==a[1].indexOf("superscript",0)&&n.append(i._buildTollbarButton("text","superscript","fa fa-superscript",null)),-1!==a[1].indexOf("color",0)&&n.append(i._buildTollbarButton("text","color","fa fa-font",null))):"align"===a[0]?(-1!==a[1].indexOf("left",0)&&n.append(i._buildTollbarButton("align","left","fa fa-align-left",null,"Align left",null)),-1!==a[1].indexOf("center",0)&&n.append(i._buildTollbarButton("align","center","fa fa-align-center",null,"Align center",null)),-1!==a[1].indexOf("right",0)&&n.append(i._buildTollbarButton("align","right","fa fa-align-right",null,"Align right",null)),-1!==a[1].indexOf("justify",0)&&n.append(i._buildTollbarButton("align","justify","fa fa-align-justify",null,"Justify content",null))):"lists"===a[0]?(-1!==a[1].indexOf("unordered",0)&&n.append(i._buildTollbarButton("lists","unordered","fa fa-list-ul",null)),-1!==a[1].indexOf("ordered",0)&&n.append(i._buildTollbarButton("lists","ordered","fa fa-list-ol",null)),-1!==a[1].indexOf("indent",0)&&n.append(i._buildTollbarButton("lists","indent","fa fa-indent",null)),-1!==a[1].indexOf("outdent",0)&&n.append(i._buildTollbarButton("lists","outdent","fa fa-outdent",null))):"components"===a[0]?(-1!==a[1].indexOf("table",0)&&n.append(i._buildTollbarButton("components","table","fa fa-table",null)),-1!==a[1].indexOf("chart",0)&&n.append(i._buildTollbarButton("components","chart","fa fa-pie-chart",null))):"intervals"===a[0]?(-1!==a[1].indexOf("line-height",0)&&n.append(i._buildTollbarButton("interval","line-height","fa fa-text-height",null,"Lines interval",function(){return'<ul class="nav nav-pills nav-stacked">\n  <li role="presentation"><a href="#" data-action="line-height" data-value="0.5">0.5</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="1.0">1.0</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="1.15">1.15</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="1.5">1.5</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="2.0">2.0</a></li>\n</ul>'})),-1!==a[1].indexOf("letter-spacing",0)&&n.append(i._buildTollbarButton("interval","letter-spacing","fa fa-text-width",null,"Letter spacing",function(){return'<ul class="nav nav-pills nav-stacked">\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-5">-5</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-3">-3</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-2">-2</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-1">-1</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="0">0</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="1">1</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="2">2</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="3">3</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="5">5</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="8">8</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="10">10</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="12">12</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="15">15</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="25">25</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="50">50</a></li>\n</ul>'}))):"insert"===a[0]?(-1!==a[1].indexOf("emoji",0)&&n.append(i._buildTollbarButton("insert","emoji","fa fa-smile-o",null)),-1!==a[1].indexOf("link",0)&&n.append(i._buildTollbarButton("insert","link","fa fa-link",null)),-1!==a[1].indexOf("image",0)&&n.append(i._buildTollbarButton("insert","image","fa fa-image",null)),-1!==a[1].indexOf("video",0)&&n.append(i._buildTollbarButton("insert","video","fa fa-video-camera",null)),-1!==a[1].indexOf("symbol",0)&&n.append(i._buildTollbarButton("insert","symbol","fa fa-hashtag",null)),-1!==a[1].indexOf("bookmark",0)&&n.append(i._buildTollbarButton("insert","bookmark","fa fa-bookmark",null))):"special"===a[0]?(-1!==a[1].indexOf("print",0)&&n.append(i._buildTollbarButton("special","print","fa fa-print",null)),-1!==a[1].indexOf("clean",0)&&n.append(i._buildTollbarButton("special","clean","fa fa-eraser",null)),-1!==a[1].indexOf("unformat",0)&&n.append(i._buildTollbarButton("special","unformat","fa fa-trash-o",null))):"fullscreen"===a[0]&&(n.addClass("pull-right"),n.append(i._buildTollbarButton("fullscreen",!0,"fa fa-arrows-alt",null)));i._$toolbar.append(n)}),i._$toolbar.length&&i._$toolbar.on("click","[data-action]",function(e){var a=t(e.currentTarget),n=a.data("action"),o=a.data("value");if(void 0!==n&&void 0!==o)switch(n){case"mode":switch(o){case"editor":i._config.mode!==o&&(i._config.mode=o,i._$content.html(i._source),i._$toolbar.find('[data-action="mode"]').removeClass("active"),i._$toolbar.find('[data-action="mode"][data-value="editor"]').addClass("active"),i._$content.addClass("editor-mode").removeClass("source-mode"),i._$content.focus());break;case"source":if(i._config.mode!==o){i._config.mode=o,i._source=i._$content.html();var l=t("<pre />");l.text(i._source),i._$content.html(i._trimSource(l.html())),i._$toolbar.find('[data-action="mode"]').removeClass("active"),i._$toolbar.find('[data-action="mode"][data-value="source"]').addClass("active"),i._$content.removeClass("editor-mode").addClass("source-mode"),i._$content.focus()}}break;case"formatblock":i._formatDoc("formatblock",o);break;case"fontname":i._formatDoc("fontname",o);break;case"fontsize":(s=document.getSelection()).anchorNode.parentElement.removeAttribute("size"),s.anchorNode.parentElement.style.fontSize=o;break;case"style":var r=(s=document.getSelection()).anchorNode.parentElement.style.cssText;r?r+=o:r=o,s.anchorNode.parentElement.removeAttribute("style"),s.anchorNode.parentElement.style=r;break;case"fullscreen":console.log("Fire action: "+n+" with value: "+o);break;case"operations":switch(o){case"undo":i._formatDoc("undo");break;case"rendo":i._formatDoc("rendo");break;case"cut":i._formatDoc("cut");break;case"copy":i._formatDoc("copy");break;case"paste":i._formatDoc("paste")}break;case"text":switch(o){case"bold":i._formatDoc("bold");break;case"italic":i._formatDoc("italic");break;case"underline":i._formatDoc("underline");break;case"strike":i._formatDoc("strikeThrough");break;case"subscript":i._formatDoc("subscript");break;case"superscript":i._formatDoc("superscript");break;case"color":console.log("Fire action: "+n+" with value: "+o)}break;case"align":switch(o){case"left":i._formatDoc("justifyLeft");break;case"center":i._formatDoc("justifyCenter");break;case"right":i._formatDoc("justifyRight");break;case"justify":i._formatDoc("justifyFull")}break;case"lists":switch(o){case"unordered":i._formatDoc("insertUnorderedList");break;case"ordered":i._formatDoc("insertOrderedList");break;case"indent":i._formatDoc("indent");break;case"outdent":i._formatDoc("outdent")}break;case"components":switch(o){case"table":case"chart":console.log("Fire action: "+n+" with value: "+o)}break;case"line-height":console.log(parseFloat(o));var s=document.getSelection(),c=100*parseFloat(o)+"%";0==parseFloat(o)&&(s.anchorNode.parentElement.style.letterSpacing="inherit"),s.anchorNode&&(s.anchorNode.parentElement.style.lineHeight=c);break;case"letter-spacing":console.log(parseFloat(o));s=document.getSelection();var d=parseFloat(o)+"px";0==parseFloat(o)&&(s.anchorNode.parentElement.style.letterSpacing="inherit"),s.anchorNode&&(s.anchorNode.parentElement.style.letterSpacing=d);break;case"insert":switch(o){case"emoji":case"link":case"image":case"video":case"symbol":case"bookmark":console.log("Fire action: "+n+" with value: "+o)}break;case"special":switch(o){case"print":i._printDoc();break;case"clean":i._formatDoc("removeFormat");break;case"unformat":i._formatDoc("selectAll"),i._formatDoc("removeFormat");var u=i._$content.html();u=(u=(u=i._stripTags(u)).replace(/(\r\n|\n|\r)/g,"\x3c!-- br --\x3e")).replace(/<!-- br -->/g,"<br/>"),i._$content.html(u)}break;default:console.warn("Unrecognized action: "+n+" with value: "+o)}}),i._$content.on("mouseup keyup",function(e){var a=window.getSelection();if(a.getRangeAt&&a.rangeCount)if(a.parentNode){var n=t(a.parentNode);i._updateState(n)}else if(a.parentElement){n=t(a.parentElement);i._updateState(n)}}),i._$content.on("click keyup",function(e){const a=t(this);window.getSelection();var n=t(e.target);i._updateState(n),a.focus(),a.trigger("change")}),i._$content.on("change",function(e){const a=t(this);"editor"==i._config.mode?i._source=a.html():i._source=a.text(),i._$element.val(i._source)})}return e(o,{element:{value:function(){return this._$element}},_stripTags:{value:function(t,e){var a="",n=!1,o=[],l=[],i="",r=0,s="",c="",d=function(t,e,a){return a.split(t).join(e)};for(a in e&&(l=e.match(/([a-zA-Z]+)/gi)),o=(t+="").match(/(<\/?[\S][^>]*>)/gi))if(!isNaN(a)){for(s in c=o[a].toString(),n=!1,l)if(i=l[s],0!=(r=-1)&&(r=c.toLowerCase().indexOf("<"+i+">")),0!=r&&(r=c.toLowerCase().indexOf("<"+i+" ")),0!=r&&(r=c.toLowerCase().indexOf("</"+i)),0==r){n=!0;break}n||(t=d(c,"",t))}return t}},_trimSource:{value:function(t){return t=(t=(t=t.replace(/\s{4,}/g,"")).replace(/\t/g," ")).toString().trim().replace(/(\r\n|\n|\r)/g,"")}},_getPath:{value:function(e,a){for(var n,o=[];e.length;){var l=e[0],i=l.localName,r=e.parentsUntil(a);if(!i)break;i=i.toLowerCase(),o.push(i);var s=t(l).attr("id");s&&(i+="#"+s);var c=t(l).attr("class");c&&(i+="."+c.replace(/\./g,".")),n=i+(n?" > "+n:""),e=r}return{path:n,tags:o}}},_getTextStat:{value:function(t){var e;return e=t&&t.contentEditable?t.innerText.replace(/\r\n/g,"\n"):t.value.replace(/\r\n/g,"\n"),{words:this._stripTags(e).split(" ").length,length:e.length,chars:this._trimSource(e.replace(/\s/g,"")).length}}},_getTextPosition:{value:function(t){var e,a,n,o,l,i=0,r=0,s=0,c=t&&t.contentEditable;return"selectionStart"in t&&document.activeElement==t?(r=t.selectionStart,s=t.selectionEnd,i=(e=t.value.replace(/\r\n/g,"\n")).substr(0,t.selectionStart).split("\n").length):c?(r=window.getSelection().getRangeAt(0).startOffset,s=window.getSelection().getRangeAt(0).endOffset,0==(i=(e=t.innerText.replace(/\r\n/g,"\n")).substr(0,t.selectionStart).split("\n").length-1)&&(i=1)):(a=document.selection.createRange())&&a.parentElement()==t&&(o=t.value.length,e=t.value.replace(/\r\n/g,"\n"),(n=t.createTextRange()).moveToBookmark(a.getBookmark()),(l=t.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",l)>-1?r=s=o:(r=-n.moveStart("character",-o),r+=e.slice(0,r).split("\n").length-1,n.compareEndPoints("EndToEnd",l)>-1?s=o:(s=-n.moveEnd("character",-o),s+=e.slice(0,s).split("\n").length-1))),{line:i,start:r,end:s}}},_formatDoc:{value:function(t,e){document.execCommand(t,!1,e),this._$content.focus()}},_printDoc:{value:function(){var t=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");t.document.open(),t.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this._$content.get(0).innerHTML+"</body></html>"),t.document.close()}},_buildTollbarButton:{value:function(e,a,n,o,l,i){var r=t('<button type="button" class="btn btn-default" tabindex="-1" />');return e&&r.attr("data-action",e),a&&r.attr("data-value",a),o&&r.attr("data-hotkey",o),l&&r.tooltip({html:!0,placement:"top",title:l.toString().trim()}),i&&r.popover({html:!0,placement:"bottom",content:i}),n&&r.append('<span class="'+n+'" />'),r}},_buildTollbarDropdown:{value:function(e,a,n){var o=t('<div class="dropdown" />'),l=t('<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" />'),i=t('<ul class="dropdown-menu" />'),r=t("<li />"),s=t('<a href="#" tabindex="-1" />');return"object"==typeof a&&t.each(a,function(a,o){var l=s.clone(),c=r.clone();"object"==typeof o?(o.action&&l.attr("data-action",o.action),o.value&&l.attr("data-value",o.value),o.wrap?l.html(t(o.wrap).text(a)):l.text(a),o.style&&l.attr("style",o.style.toString()),a==n&&c.addClass("active"),c.append(l),i.append(c)):(l.text(o),l.attr("data-action",e),l.attr("data-value",o),o==n&&c.addClass("active"),c.append(l),i.append(c))}),n?l.text(n+" "):l.text("Dropdown "),l.append('<b class="caret" />'),o.append(l),o.append(i),o}},_updateState:{value:function(t,e){if("editor"==this._config.mode){var a=this._getTextStat(this._$content.get(0)),n=this._getPath(t,this._$content);if(e)this._$toolbar.find("button[data-action]").removeClass("active");else switch(n.tags[0]){case"b":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="bold"]').addClass("active");break;case"u":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="underline"]').addClass("active");break;case"sub":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="subscript"]').addClass("active");break;case"sup":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="superscript"]').addClass("active");break;case"i":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="italic"]').addClass("active");break;case"a":this._$toolbar.find('[data-action="insert"]').removeClass("active"),this._$toolbar.find('[data-action="insert"][data-value="link"]').addClass("active");break;case"p":this._$toolbar.find('[data-action="align"]').removeClass("active"),"center"==t.css("text-align")?this._$toolbar.find('[data-action="align"][data-value="center"]').addClass("active"):"right"==t.css("text-align")?this._$toolbar.find('[data-action="align"][data-value="right"]').addClass("active"):"justify"==t.css("text-align")?this._$toolbar.find('[data-action="align"][data-value="justify"]').addClass("active"):this._$toolbar.find('[data-action="align"][data-value="left"]').addClass("active");break;default:this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="align"]').removeClass("active"),this._$toolbar.find('[data-action="insert"]').removeClass("active")}-1==n.path.search(this._editorId)&&this._$statusbar.path.text(n.path),this._$statusbar.stat.text("Length: "+a.length+", chars: "+a.chars+", words: "+a.words)}else{var o=this._getTextPosition(this._$content.get(0));this._$statusbar.path.empty(),this._$statusbar.stat.text("Line: "+o.line+", column: "+o.end)}return this._$element}}},{Default:{get:function(){return l}},_jQueryInterface:{value:function(e){var a=this;return e=e||{},a.each(function(){var l=t(a),i=t.extend({},n.Default,l.data(),"object"==typeof e&&e);new o(a,i)})}}}),o}();return t.fn.wysiwyg=i._jQueryInterface,t.fn.wysiwyg.Constructor=i,t.fn.wysiwyg.noConflict=function(){return t.fn.wysiwyg=o,i._jQueryInterface},i}(jQuery)}(jQuery);
//# sourceMappingURL=wysiwyg.js.map